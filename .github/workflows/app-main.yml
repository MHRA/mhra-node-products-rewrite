name: Build Deploy

on:
    push:
      branches:
        - main
        - feature/**
      paths:
        - "node-api/**"
        - "node-doc-index-updater/**"
        - "pars-upload/**"
        - "web/**"
        - ".github/workflows/app**"
jobs:
  Build:
    uses: ./.github/workflows/app-ci.yml
    with:
      environment: "non-prod" 
    secrets:
      REGISTRY_ADDRESS: ${{ secrets.REGISTRY_ADDRESS }}
      REGISTRY_NAME: ${{ secrets.REGISTRY_ADDRESS }}
      AZURE_CREDENTIALS: ${{ secrets.AZURE_CREDENTIALS }}
      AZURE_STORAGE_ACCOUNT: ${{ secrets.AZURE_STORAGE_ACCOUNT }}
      AZURE_STORAGE_KEY: ${{ secrets.AZURE_STORAGE_KEY }}
  # Deploy:
  #   needs: Build
  #   uses: ./.github/workflows/app-deploy.yml
  #   with:
  #     environment: "non-prod"
  #   secrets:
  #     REGISTRY_ADDRESS: ${{ secrets.REGISTRY_ADDRESS }}
  #     REGISTRY_USERNAME: ${{ secrets.REGISTRY_USERNAME }}
  #     REGISTRY_PASSWORD: ${{ secrets.REGISTRY_PASSWORD }}
  #     AZURE_CREDENTIALS: ${{ secrets.AZURE_CREDENTIALS }}
#  Owasp scan??